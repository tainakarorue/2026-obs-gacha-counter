# ガチャカウンター 使い方マニュアル

このマニュアルでは、ガチャカウンターの基本操作と、OBS Studio での配信画面への表示方法を説明します。

---

## 目次

1. [基本操作](#1-基本操作)
2. [画面の見方](#2-画面の見方)
3. [OBS での表示方法 (2つの方法)](#3-obs-での表示方法)
   - [方法A: ブラウザソースで読み込む](#方法a-ブラウザソースで読み込む推奨)
   - [方法B: ウィンドウキャプチャで読み込む](#方法b-ウィンドウキャプチャで読み込む)
4. [よくある質問](#4-よくある質問)

---

## 1. 基本操作

### ボタン操作

| ボタン | 説明 |
|--------|------|
| **+1** | 単発ガチャ。カウントを1回分増やします |
| **+10** | 10連ガチャ。カウントを10回分増やします |
| **+11** | 10連+おまけ1回のガチャ。カウントを11回分増やします |
| **獲得!** | 目当てのキャラを引いたときに押します。獲得履歴に記録されます |
| **戻す** | 直前の操作を1回だけ取り消します（押し間違い対策） |
| **リセット** | 全てのデータを初期化します（確認ダイアログが出ます） |

### キーボードショートカット

キーボードだけでも操作できます。配信中にマウスを動かさずに済むので便利です。

| キー | 操作 |
|------|------|
| `1` | 単発ガチャ (+1) |
| `2` | 10連ガチャ (+10) |
| `3` | 10連+おまけガチャ (+11) |
| `Space` (スペース) | キャラ獲得を記録 |
| `Z` | 戻す (Undo) |
| `R` | リセット |

> **注意:** キャラクター名入力欄や天井の数値入力欄にカーソルがあるときは、ショートカットは無効になります。入力欄の外をクリックしてからキーを押してください。

### 設定項目

| 項目 | 説明 |
|------|------|
| **キャラクター名** | 画面上部の入力欄に、狙っているキャラの名前を入力できます。獲得時にこの名前が履歴に記録されます |
| **天井** | 天井の回数を変更できます（初期値: 200回）。-10 / -1 / +1 / +10 ボタンまたは直接入力で変更できます |
| **1連コスト** | 総回数の右側にある入力欄に、1回のガチャに必要なクレジットやジュエルの数を入力すると、消費量が自動計算されます（0の場合は非表示） |

---

## 2. 画面の見方

```
┌────────────────────────────────┐
│    [ キャラクター名 ]            │ ← 狙っているキャラの名前
│       ガチャカウンター           │
├────────────────────────────────┤
│                                │
│        現在  75  回             │ ← 前回の獲得から何回引いたか（大きく表示）
│                                │
│   総回数 195 回  × 1連 [160]    │ ← 累計回数 × 1連コスト入力
│        消費 31,200             │ ← 消費クレジット（自動計算）
│     天井まで  5回 / 200回       │ ← 天井到達までの残り
│                                │
├────────────────────────────────┤
│  ── 獲得履歴 ──                 │
│  キャラA    45回   (累計45回目)  │ ← キャラ名付きで表示
│  キャラA    75回   (累計120回目) │
│  武器B      30回   (累計150回目) │
│                                │
│  ── 獲得サマリー ──             │
│  キャラA ×2    合計120回        │ ← キャラ別の合算
│  武器B  ×1    合計30回         │
│                                │
├────────────────────────────────┤
│  [+1] [+10] [+11] [獲得!] [戻す]│
│           [リセット]            │
│  天井: [-10][-1][200][+1][+10] 回│ ← ボタンで調整
├────────────────────────────────┤
│  1:+1  2:+10  3:+11 ...       │ ← ショートカットキーの説明
└────────────────────────────────┘
```

### 表示色の意味

| 色 | 意味 |
|----|------|
| **白 (大きい数字)** | 前回獲得からの現在の回数（メインカウンター） |
| **水色** | 総回数 |
| **ピンク** | 消費クレジット |
| **オレンジ** | 天井までの残り回数 |
| **赤色** | 天井が近い警告（残り20%以下で自動変化） |
| **金色の光** | キャラ獲得時のエフェクト |

---

## 3. OBS での表示方法

OBS にガチャカウンターを表示する方法は2つあります。

---

### 方法A: ブラウザソースで読み込む（推奨）

OBS に内蔵されているブラウザ機能で直接 HTML ファイルを表示する方法です。

#### メリット
- 背景が自動で透明になる
- 配信画面に自然に重ねられる

#### デメリット
- 操作するにはOBS上で「対話」を使う必要がある

#### 手順

**ステップ 1: index.html のパスを確認する**

1. エクスプローラーでガチャカウンターのフォルダを開きます
2. `index.html` を右クリック →「プロパティ」を選択します
3. 「場所」に表示されているパスをメモします
4. パスの末尾に `\index.html` を付けた完全なパスが必要です

例:
```
C:\Users\ユーザー名\Desktop\ガチャカウンター\index.html
```

**ステップ 2: OBS にブラウザソースを追加する**

1. OBS Studio を起動します
2. 配信で使いたいシーンを選びます
3. 「ソース」の下にある **＋ボタン** をクリックします
4. 一覧から **「ブラウザ」** を選びます
5. 「新規作成」のまま、名前を「ガチャカウンター」と入力して **OK** を押します

**ステップ 3: ブラウザソースの設定をする**

設定画面が表示されるので、以下のように設定します:

| 設定項目 | 値 |
|---------|-----|
| **ローカルファイル** | **チェックを入れる** |
| **ローカルファイル** | 「参照」を押して `index.html` を選択 |
| **幅** | `400` |
| **高さ** | `700` |

> 幅・高さは後から調整できます。まずはこの値で試してみてください。

設定できたら **OK** を押します。

**ステップ 4: 位置とサイズを調整する**

1. OBS のプレビュー画面にガチャカウンターが表示されます
2. ドラッグして好きな位置に移動できます
3. 角をドラッグしてサイズを変更できます

**ステップ 5: カウンターを操作する**

ブラウザソースに対して直接操作するには:

1. ソース一覧の「ガチャカウンター」を **右クリック** します
2. メニューから **「対話」** を選びます
3. 小さなウィンドウが開き、カウンターのボタンを押したりキーボード操作ができます
4. 操作が終わったらウィンドウを閉じます

> **ポイント:** 「対話」ウィンドウは配信中でも開けます。操作が終わったら閉じておきましょう。

**ステップ 6: ファイルを更新したときにリロードする**

ガチャカウンターのファイル（HTML / CSS / JS）を編集した場合、OBS に変更を反映するにはリロードが必要です。

1. ソース一覧の「ガチャカウンター」を **右クリック** します
2. **「プロパティ」** を選びます
3. プロパティ画面の下部にある **「現在のページのキャッシュをリフレッシュ」** をクリックします
4. **OK** を押して閉じます

これでファイルが再読み込みされ、変更が反映されます。

---

### 方法B: ウィンドウキャプチャで読み込む

ブラウザで開いたガチャカウンターの画面をそのまま OBS に取り込む方法です。

#### メリット
- ブラウザ上で直接操作できるので楽
- キーボードショートカットがそのまま使える

#### デメリット
- 背景の透過処理に追加設定が必要
- ブラウザのウィンドウを常に開いておく必要がある

#### 手順

**ステップ 1: ブラウザでガチャカウンターを開く**

1. エクスプローラーでガチャカウンターのフォルダを開きます
2. `index.html` をダブルクリックします（Google Chrome で開くのを推奨）
3. ブラウザにガチャカウンターが表示されます

> **ポイント:** Chrome が既定のブラウザでない場合は、`index.html` を右クリック →「プログラムから開く」→「Google Chrome」を選んでください。

**ステップ 2: ブラウザのウィンドウサイズを調整する**

1. ガチャカウンターが見やすいサイズにウィンドウを調整します
2. ブックマークバーやタブが映らないよう、後でトリミングします

> **ポイント (任意):** Chrome で `F11` を押すと全画面表示になり、余計なUIが消えます。もう一度 `F11` で戻ります。

**ステップ 3: OBS にウィンドウキャプチャを追加する**

1. OBS Studio を起動します
2. 「ソース」の下にある **＋ボタン** をクリックします
3. 一覧から **「ウィンドウキャプチャ」** を選びます
4. 「新規作成」のまま、名前を「ガチャカウンター」として **OK** を押します

**ステップ 4: キャプチャするウィンドウを選ぶ**

1. 「ウィンドウ」のドロップダウンをクリックします
2. 一覧からガチャカウンターを開いているブラウザのウィンドウを選びます
   - 例: `[chrome.exe]: ガチャカウンター`
3. **OK** を押します

**ステップ 5: 背景を透明にする（クロマキー設定）**

ウィンドウキャプチャではそのままだとブラウザの背景色が表示されてしまいます。
背景を透明にするには以下の手順で設定します。

1. まず、ブラウザ側の準備をします。`index.html` を開いているブラウザのアドレスバーの URL の末尾に `#green` は不要です。代わりに以下のフィルタ設定を行います。

2. OBS のソース一覧で「ガチャカウンター」を **右クリック** します
3. **「フィルタ」** を選びます
4. 左下の **＋ボタン** をクリックします
5. **「クロマキー」** を選択し、OK を押します
6. 以下のように設定します:

| 設定項目 | 値 |
|---------|-----|
| **色キーの種類** | 「カスタム」を選択 |
| **色** | ブラウザの背景色に合わせる（白なら白、黒に近い色なら暗い色を選択）|
| **類似性** | スライダーで調整して背景だけが消えるようにする |
| **滑らかさ** | 少し上げると境界がきれいになります |

> **ポイント:** 背景を消しやすくするため、ブラウザの背景色をグリーンバックにする方法もあります。その場合は `css/style.css` の `body` の `background` を `#00ff00` に変更し、クロマキーの色キーの種類を「緑」にしてください。

**ステップ 6: 位置とサイズを調整する**

1. OBS のプレビュー画面でドラッグして位置を調整します
2. `Alt` キーを押しながら辺をドラッグすると、不要な部分をトリミングできます
   - ブラウザのタブバーやアドレスバーをトリミングで隠しましょう

**ステップ 7: カウンターを操作する**

- ブラウザのウィンドウをクリックして、ボタンやキーボードで直接操作します
- OBS の配信とは別に、ブラウザのウィンドウを操作できます

---

## 方法A と 方法B の比較

| 項目 | 方法A (ブラウザソース) | 方法B (ウィンドウキャプチャ) |
|------|----------------------|---------------------------|
| 導入の手軽さ | 簡単 | やや手間 |
| 背景透過 | 自動 | クロマキー設定が必要 |
| 操作方法 | OBS の「対話」から操作 | ブラウザで直接操作 |
| 操作のしやすさ | やや手間 | 簡単・ショートカット対応 |
| 別ウィンドウ不要 | 不要 | ブラウザを開いておく必要あり |
| おすすめ場面 | 表示だけでOK・操作頻度が低い | 頻繁に操作する・ショートカットを使いたい |

---

## 4. よくある質問

### Q. データはどこに保存されていますか？

ブラウザの `localStorage` に自動保存されています。ファイルとして書き出されるわけではないので、ブラウザのデータを消去するとリセットされます。

### Q. OBS のブラウザソースとブラウザで同時に開いたらどうなりますか？

それぞれ別の localStorage を使うため、データは共有されません。どちらか一方で操作してください。

### Q. 天井の回数はゲームによって違いますが変更できますか？

はい。画面下部の「天井:」の -10 / -1 / +1 / +10 ボタンで調整するか、数値を直接入力して変更できます。変更は自動で保存されます。

### Q. 消費したジュエルやクレジットを確認できますか？

はい。「総回数」の右側にある「1連」の入力欄に、ガチャ1回分のコスト（例: 160）を入力すると、消費量が自動計算されて表示されます。0 のままにすると消費行は非表示になります。

### Q. 複数のキャラや武器を続けて引いたとき、履歴で区別できますか？

はい。キャラクター名入力欄に名前を入力した状態で「獲得!」を押すと、その名前が履歴に記録されます。キャラが変わったら名前を書き換えてから「獲得!」を押してください。獲得サマリーにキャラごとの合算も表示されます。

### Q. 10連ガチャで +10 と +11 はどう使い分けますか？

- **+10**: 10連で10回引くガチャ用です
- **+11**: 10連でおまけ1回が付いて合計11回引くガチャ用です（一部のゲームにあるサービス）

遊んでいるゲームの仕様に合わせて使い分けてください。

### Q. 間違えてカウントしてしまいました

「戻す」ボタン、またはキーボードの `Z` を押すと直前の操作を取り消せます。

### Q. リセットしたらデータは元に戻せますか？

リセット後は元に戻せません。リセット前に確認ダイアログが表示されるので、よく確認してから実行してください。

### Q. フォントや色を変えたいです

`css/style.css` をテキストエディタ（メモ帳など）で開いて編集できます。主な変更箇所:

| やりたいこと | 変更箇所 |
|-------------|---------|
| 文字の色を変える | `color: #ffffff;` の `#ffffff` 部分を変更 |
| 文字の大きさを変える | `font-size: 56px;` の数値を変更 |
| 背景の透明度を変える | `rgba(15, 15, 25, 0.85)` の `0.85` を変更（0で完全透明、1で不透明） |
